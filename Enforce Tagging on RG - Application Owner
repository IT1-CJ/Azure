{
  "properties": {
    "displayName": "Enforce Tagging on RG - Application Owner",
    "policyType": "Custom",
    "mode": "All",
    "metadata": {
      "category": "Tagging Enforcement",
      "createdBy": "932afd75-7811-42c8-9e5e-1d37e2b74db8",
      "createdOn": "2023-05-23T15:33:23.2933236Z",
      "updatedBy": "66fd68bb-83a0-4a3d-88b7-21bad65d916e",
      "updatedOn": "2023-12-21T16:05:17.5865529Z"
    },
    "version": "1.0.0",
    "parameters": {
      "effect": {
        "type": "String",
        "metadata": {
          "displayName": "Effect",
          "description": "Enable or disable the execution of the audit policy"
        },
        "allowedValues": [
          "Audit",
          "Deny",
          "Disabled"
        ],
        "defaultValue": "Deny"
      },
      "tagName": {
        "type": "String",
        "metadata": {
          "displayName": "Application Owner",
          "description": "Name of the tag, such as 'Application Owner'"
        },
        "defaultValue": "Application Owner"
      },
      "listofallowedtagValues": {
        "type": "Array",
        "metadata": {
          "displayName": "Tag Values",
          "description": "Value of the tag, such as 'production'"
        },
        "allowedValues": [
          "Ryan Waller",
          "Tony Rosas",
          "Tom Mason",
          "Rick Erickson",
          "Kyle Wellik",
          "Pete Newton",
          "Carolyn Lyon",
          "Dave Gilpin",
          "Seth Thomas",
          "NETOPS",
          "IT1",
          "IT",
          "UNKNOWN",
          "Alex Esterly",
          "ASRC",
          "AES",
          "RSI",
          "PSI",
          "GES",
          "LRS",
          "EQM",
          "AIS",
          "RST",
          "NOC",
          "Dillon O'Brien",
          "Jerry Lopez"
        ]
      }
    },
    "policyRule": {
      "if": {
        "allOf": [
          {
            "field": "type",
            "equals": "Microsoft.Resources/subscriptions/resourceGroups"
          },
          {
            "not": {
              "field": "[concat('tags[', parameters('tagName'), ']')]",
              "in": "[parameters('listofallowedtagValues')]"
            }
          }
        ]
      },
      "then": {
        "effect": "[parameters('effect')]"
      }
    },
    "versions": [
      "1.0.0"
    ]
  },
  "id": "/subscriptions/0684bbd8-5e8d-4e96-86f1-4c24f0e259b5/providers/Microsoft.Authorization/policyDefinitions/8f5067f5-913b-4185-a72e-e816717f1781",
  "type": "Microsoft.Authorization/policyDefinitions",
  "name": "8f5067f5-913b-4185-a72e-e816717f1781",
  "systemData": {
    "createdBy": "adm-adaly@asrc.com",
    "createdByType": "User",
    "createdAt": "2023-05-23T15:33:23.2677598Z",
    "lastModifiedBy": "adm-jcarroll@asrc.com",
    "lastModifiedByType": "User",
    "lastModifiedAt": "2023-12-21T16:05:17.5426886Z"
  }
}
